2025-01-08 12:09:13 | [CL_point_env] Logging to /Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/data/local/experiment/CL_point_env_5


Failed to import TF-Keras. Please note that TF-Keras is not installed by default when you install TensorFlow Probability. This is so that JAX-only users do not have to install TensorFlow or TF-Keras. To use TensorFlow Probability with TensorFlow, please install the tf-keras or tf-keras-nightly package.
This can be be done through installing the tensorflow-probability[tf] extra.
/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/experiment/deterministic.py:36: UserWarning: Enabeling deterministic mode in PyTorch can have a performance impact when using GPU.
  warnings.warn(


2025-01-08 12:09:14 | [CL_point_env] Obtaining samples...
/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/distributions/distribution.py:53: UserWarning: <class 'garage.torch.distributions.tanh_normal.TanhNormal'> does not define `arg_constraints`. Please set `arg_constraints = {}` or initialize the distribution with `validate_args=False` to turn off validation.
  warnings.warn(
/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/_dtypes.py:1051: UserWarning: Observation array([0., 0., 2.]) is outside observation_space Box(-inf, inf, (3,), float32)
  warnings.warn(
2025-01-08 12:09:16 | [CL_point_env] epoch #0 | Pre-Training Encoder...
2025-01-08 12:09:31 | [CL_point_env] epoch #0 | Pre-Training Encoder Done...
2025-01-08 12:09:31 | [CL_point_env] epoch #0 | Training...
2025-01-08 12:09:32 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 12:09:51 | [CL_point_env] epoch #0 | Evaluating...
2025-01-08 12:09:51 | [CL_point_env] epoch #0 | Sampling for adapation and meta-testing...


Failed to import TF-Keras. Please note that TF-Keras is not installed by default when you install TensorFlow Probability. This is so that JAX-only users do not have to install TensorFlow or TF-Keras. To use TensorFlow Probability with TensorFlow, please install the tf-keras or tf-keras-nightly package.
This can be be done through installing the tensorflow-probability[tf] extra.
/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/experiment/deterministic.py:36: UserWarning: Enabeling deterministic mode in PyTorch can have a performance impact when using GPU.
  warnings.warn(


2025-01-08 12:09:52 | [CL_point_env] epoch #0 | Finished meta-testing...
2025-01-08 12:09:53 | [CL_point_env] epoch #0 | Sampling for adapation and meta-testing...


Failed to import TF-Keras. Please note that TF-Keras is not installed by default when you install TensorFlow Probability. This is so that JAX-only users do not have to install TensorFlow or TF-Keras. To use TensorFlow Probability with TensorFlow, please install the tf-keras or tf-keras-nightly package.
This can be be done through installing the tensorflow-probability[tf] extra.


2025-01-08 12:09:55 | [CL_point_env] epoch #0 | Finished meta-testing...
2025-01-08 12:09:55 | [CL_point_env] epoch #0 | Saving snapshot...
2025-01-08 12:09:55 | [CL_point_env] epoch #0 | Saved
2025-01-08 12:09:55 | [CL_point_env] epoch #0 | Time 41.09 s
2025-01-08 12:09:55 | [CL_point_env] epoch #0 | EpochTime 41.09 s
--------------------------------------------------  ---------
MetaTest/Average/AverageDiscountedReturn            -207.758
MetaTest/Average/AverageReturn                      -207.758
MetaTest/Average/Iteration                             0
MetaTest/Average/MaxReturn                          -145.403
MetaTest/Average/MinReturn                          -249.327
MetaTest/Average/NumEpisodes                           5
MetaTest/Average/StdReturn                            43.6356
MetaTest/Average/SuccessRate                           0
MetaTest/Average/TerminationRate                       0
MetaTest/__unnamed_task__/AverageDiscountedReturn   -207.758
MetaTest/__unnamed_task__/AverageReturn             -207.758
MetaTest/__unnamed_task__/Iteration                    0
MetaTest/__unnamed_task__/MaxReturn                 -145.403
MetaTest/__unnamed_task__/MinReturn                 -249.327
MetaTest/__unnamed_task__/NumEpisodes                  5
MetaTest/__unnamed_task__/StdReturn                   43.6356
MetaTest/__unnamed_task__/SuccessRate                  0
MetaTest/__unnamed_task__/TerminationRate              0
MetaTrain/Average/AverageDiscountedReturn           -208.101
MetaTrain/Average/AverageReturn                     -208.101
MetaTrain/Average/Iteration                            0
MetaTrain/Average/MaxReturn                         -177.222
MetaTrain/Average/MinReturn                         -238.98
MetaTrain/Average/NumEpisodes                          2
MetaTrain/Average/StdReturn                           30.8786
MetaTrain/Average/SuccessRate                          0
MetaTrain/Average/TerminationRate                      0
MetaTrain/__unnamed_task__/AverageDiscountedReturn  -208.101
MetaTrain/__unnamed_task__/AverageReturn            -208.101
MetaTrain/__unnamed_task__/Iteration                   0
MetaTrain/__unnamed_task__/MaxReturn                -177.222
MetaTrain/__unnamed_task__/MinReturn                -238.98
MetaTrain/__unnamed_task__/NumEpisodes                 2
MetaTrain/__unnamed_task__/StdReturn                  30.8786
MetaTrain/__unnamed_task__/SuccessRate                 0
MetaTrain/__unnamed_task__/TerminationRate             0
TotalEnvSteps                                       6900
--------------------------------------------------  ---------
2025-01-08 12:09:57 | [CL_point_env] epoch #1 | Training...
2025-01-08 12:10:01 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 12:10:21 | [CL_point_env] epoch #1 | Evaluating...
2025-01-08 12:10:21 | [CL_point_env] epoch #1 | Sampling for adapation and meta-testing...
2025-01-08 12:10:21 | [CL_point_env] epoch #1 | Finished meta-testing...
2025-01-08 12:10:22 | [CL_point_env] epoch #1 | Sampling for adapation and meta-testing...
2025-01-08 12:10:24 | [CL_point_env] epoch #1 | Finished meta-testing...
2025-01-08 12:10:24 | [CL_point_env] epoch #1 | Saving snapshot...
2025-01-08 12:10:24 | [CL_point_env] epoch #1 | Saved
2025-01-08 12:10:24 | [CL_point_env] epoch #1 | Time 70.08 s
2025-01-08 12:10:24 | [CL_point_env] epoch #1 | EpochTime 28.99 s
--------------------------------------------------  ----------
MetaTest/Average/AverageDiscountedReturn             -206.293
MetaTest/Average/AverageReturn                       -206.293
MetaTest/Average/Iteration                              1
MetaTest/Average/MaxReturn                           -170.164
MetaTest/Average/MinReturn                           -260.216
MetaTest/Average/NumEpisodes                            5
MetaTest/Average/StdReturn                             35.3617
MetaTest/Average/SuccessRate                            0
MetaTest/Average/TerminationRate                        0
MetaTest/__unnamed_task__/AverageDiscountedReturn    -206.293
MetaTest/__unnamed_task__/AverageReturn              -206.293
MetaTest/__unnamed_task__/Iteration                     1
MetaTest/__unnamed_task__/MaxReturn                  -170.164
MetaTest/__unnamed_task__/MinReturn                  -260.216
MetaTest/__unnamed_task__/NumEpisodes                   5
MetaTest/__unnamed_task__/StdReturn                    35.3617
MetaTest/__unnamed_task__/SuccessRate                   0
MetaTest/__unnamed_task__/TerminationRate               0
MetaTrain/Average/AverageDiscountedReturn            -215.607
MetaTrain/Average/AverageReturn                      -215.607
MetaTrain/Average/Iteration                             1
MetaTrain/Average/MaxReturn                          -169.93
MetaTrain/Average/MinReturn                          -261.285
MetaTrain/Average/NumEpisodes                           2
MetaTrain/Average/StdReturn                            45.6779
MetaTrain/Average/SuccessRate                           0
MetaTrain/Average/TerminationRate                       0
MetaTrain/__unnamed_task__/AverageDiscountedReturn   -215.607
MetaTrain/__unnamed_task__/AverageReturn             -215.607
MetaTrain/__unnamed_task__/Iteration                    1
MetaTrain/__unnamed_task__/MaxReturn                 -169.93
MetaTrain/__unnamed_task__/MinReturn                 -261.285
MetaTrain/__unnamed_task__/NumEpisodes                  2
MetaTrain/__unnamed_task__/StdReturn                   45.6779
MetaTrain/__unnamed_task__/SuccessRate                  0
MetaTrain/__unnamed_task__/TerminationRate              0
TotalEnvSteps                                       11400
--------------------------------------------------  ----------
2025-01-08 12:10:26 | [CL_point_env] epoch #2 | Training...
2025-01-08 12:10:32 | [CL_point_env] epoch #2 | Training Encoder

2025-01-08 12:10:51 | [CL_point_env] epoch #2 | Evaluating...
2025-01-08 12:10:51 | [CL_point_env] epoch #2 | Sampling for adapation and meta-testing...
2025-01-08 12:10:52 | [CL_point_env] epoch #2 | Finished meta-testing...
2025-01-08 12:10:52 | [CL_point_env] epoch #2 | Sampling for adapation and meta-testing...
Traceback (most recent call last):
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/examples/torch/multi_env_CL.py", line 205, in <module>
    CL_point_env()
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/experiment/experiment.py", line 369, in __call__
    result = self.function(ctxt, **kwargs)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/examples/torch/multi_env_CL.py", line 202, in CL_point_env
    trainer.train(n_epochs=num_epochs, batch_size=batch_size)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/trainer.py", line 396, in train
    average_return = self._algo.train(self)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/algos/CLMeta.py", line 343, in train
    self._test_evaluator.evaluate(self)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/experiment/meta_evaluator.py", line 110, in evaluate
    eps = EpisodeBatch.concatenate(*[
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/experiment/meta_evaluator.py", line 111, in <listcomp>
    self._test_sampler.obtain_samples(self._eval_itr, 1, policy,
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/sampler/local_sampler.py", line 160, in obtain_samples
    batch = worker.rollout()
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/algos/CLMeta.py", line 900, in rollout
    while not self.step_episode():
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/algos/CLMeta.py", line 867, in step_episode
    a, agent_info = self.agent.get_action(self._prev_obs)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/policies/cl_context_conditioned_policy.py", line 217, in get_action
    action, info = self._policy.get_action(obs_in)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/policies/stochastic_policy.py", line 47, in get_action
    action, agent_infos = self.get_actions(observation)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/policies/stochastic_policy.py", line 95, in get_actions
    dist, info = self.forward(observations)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/policies/tanh_gaussian_mlp_policy.py", line 102, in forward
    dist = self._module(observations)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/modules/gaussian_mlp_module.py", line 171, in forward
    mean, log_std_uncentered = self._get_mean_and_log_std(*inputs)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/modules/gaussian_mlp_module.py", line 572, in _get_mean_and_log_std
    return self._shared_mean_log_std_network(*inputs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/modules/multi_headed_mlp_module.py", line 149, in forward
    x = layer(x)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
Traceback (most recent call last):
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/examples/torch/multi_env_CL.py", line 205, in <module>
    CL_point_env()
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/experiment/experiment.py", line 369, in __call__
    result = self.function(ctxt, **kwargs)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/examples/torch/multi_env_CL.py", line 202, in CL_point_env
    trainer.train(n_epochs=num_epochs, batch_size=batch_size)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/trainer.py", line 396, in train
    average_return = self._algo.train(self)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/algos/CLMeta.py", line 343, in train
    self._test_evaluator.evaluate(self)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/experiment/meta_evaluator.py", line 110, in evaluate
    eps = EpisodeBatch.concatenate(*[
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/experiment/meta_evaluator.py", line 111, in <listcomp>
    self._test_sampler.obtain_samples(self._eval_itr, 1, policy,
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/sampler/local_sampler.py", line 160, in obtain_samples
    batch = worker.rollout()
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/algos/CLMeta.py", line 900, in rollout
    while not self.step_episode():
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/algos/CLMeta.py", line 867, in step_episode
    a, agent_info = self.agent.get_action(self._prev_obs)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/policies/cl_context_conditioned_policy.py", line 217, in get_action
    action, info = self._policy.get_action(obs_in)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/policies/stochastic_policy.py", line 47, in get_action
    action, agent_infos = self.get_actions(observation)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/policies/stochastic_policy.py", line 95, in get_actions
    dist, info = self.forward(observations)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/policies/tanh_gaussian_mlp_policy.py", line 102, in forward
    dist = self._module(observations)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/modules/gaussian_mlp_module.py", line 171, in forward
    mean, log_std_uncentered = self._get_mean_and_log_std(*inputs)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/modules/gaussian_mlp_module.py", line 572, in _get_mean_and_log_std
    return self._shared_mean_log_std_network(*inputs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl-9916970f86b9202e9d7063b26b7a6a23cc989802/garage/torch/modules/multi_headed_mlp_module.py", line 149, in forward
    x = layer(x)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
