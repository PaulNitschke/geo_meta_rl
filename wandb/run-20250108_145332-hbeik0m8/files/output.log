2025-01-08 14:53:34 | [CL_point_env] Logging to /Users/paulnitschke/Desktop/projects/geo_meta_rl/data/local/experiment/CL_point_env_15


Failed to import TF-Keras. Please note that TF-Keras is not installed by default when you install TensorFlow Probability. This is so that JAX-only users do not have to install TensorFlow or TF-Keras. To use TensorFlow Probability with TensorFlow, please install the tf-keras or tf-keras-nightly package.
This can be be done through installing the tensorflow-probability[tf] extra.
/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/experiment/deterministic.py:36: UserWarning: Enabeling deterministic mode in PyTorch can have a performance impact when using GPU.
  warnings.warn(


2025-01-08 14:53:35 | [CL_point_env] Obtaining samples...
/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/distributions/distribution.py:53: UserWarning: <class 'garage.torch.distributions.tanh_normal.TanhNormal'> does not define `arg_constraints`. Please set `arg_constraints = {}` or initialize the distribution with `validate_args=False` to turn off validation.
  warnings.warn(
/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/_dtypes.py:1051: UserWarning: Observation array([0., 0., 2.]) is outside observation_space Box(-inf, inf, (3,), float32)
  warnings.warn(
2025-01-08 14:53:37 | [CL_point_env] epoch #0 | Pre-Training Encoder...
2025-01-08 14:53:50 | [CL_point_env] epoch #0 | Pre-Training Encoder Done...
2025-01-08 14:53:50 | [CL_point_env] epoch #0 | Training...
2025-01-08 14:53:51 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:54:11 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:54:31 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:54:51 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:55:11 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:55:31 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:55:51 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:56:11 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:56:31 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:56:51 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:57:11 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:57:31 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:57:51 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:58:11 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:58:31 | [CL_point_env] epoch #0 | Training Encoder

2025-01-08 14:58:50 | [CL_point_env] epoch #0 | Evaluating...
2025-01-08 14:58:50 | [CL_point_env] epoch #0 | Sampling for adapation and meta-testing...


Failed to import TF-Keras. Please note that TF-Keras is not installed by default when you install TensorFlow Probability. This is so that JAX-only users do not have to install TensorFlow or TF-Keras. To use TensorFlow Probability with TensorFlow, please install the tf-keras or tf-keras-nightly package.
This can be be done through installing the tensorflow-probability[tf] extra.
/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/experiment/deterministic.py:36: UserWarning: Enabeling deterministic mode in PyTorch can have a performance impact when using GPU.
  warnings.warn(


2025-01-08 14:58:51 | [CL_point_env] epoch #0 | Finished meta-testing...
embedding:  [[ 0.22149636  0.40747315  0.33808878  0.64399093 -0.5058425 ]]
embedding:  [[-0.21888785 -0.6707797   0.01958706 -0.14643572  0.69304806]]
2025-01-08 14:58:52 | [CL_point_env] epoch #0 | Sampling for adapation and meta-testing...


Failed to import TF-Keras. Please note that TF-Keras is not installed by default when you install TensorFlow Probability. This is so that JAX-only users do not have to install TensorFlow or TF-Keras. To use TensorFlow Probability with TensorFlow, please install the tf-keras or tf-keras-nightly package.
This can be be done through installing the tensorflow-probability[tf] extra.


2025-01-08 14:58:54 | [CL_point_env] epoch #0 | Finished meta-testing...
embedding:  [[ 0.22149636  0.40747315  0.33808878  0.64399093 -0.5058425 ]]
embedding:  [[-0.10334042 -0.56379956  0.41710928  0.43101963  0.5582945 ]]
embedding:  [[-0.22137263 -0.66156864  0.02414746 -0.1655705   0.69665223]]
embedding:  [[-0.22272484 -0.65943396  0.00962251 -0.17701916  0.6957817 ]]
embedding:  [[-0.11931477 -0.5505172   0.40977988  0.45668605  0.5533653 ]]
2025-01-08 14:58:55 | [CL_point_env] epoch #0 | Saving snapshot...
2025-01-08 14:58:55 | [CL_point_env] epoch #0 | Saved
2025-01-08 14:58:55 | [CL_point_env] epoch #0 | Time 320.65 s
2025-01-08 14:58:55 | [CL_point_env] epoch #0 | EpochTime 320.65 s
--------------------------------------------------  ----------
MetaTest/Average/AverageDiscountedReturn            -431.668
MetaTest/Average/AverageReturn                      -431.668
MetaTest/Average/Iteration                             0
MetaTest/Average/MaxReturn                          -247.946
MetaTest/Average/MinReturn                          -563.339
MetaTest/Average/NumEpisodes                           5
MetaTest/Average/StdReturn                           133.188
MetaTest/Average/SuccessRate                           0
MetaTest/Average/TerminationRate                       0
MetaTest/__unnamed_task__/AverageDiscountedReturn   -431.668
MetaTest/__unnamed_task__/AverageReturn             -431.668
MetaTest/__unnamed_task__/Iteration                    0
MetaTest/__unnamed_task__/MaxReturn                 -247.946
MetaTest/__unnamed_task__/MinReturn                 -563.339
MetaTest/__unnamed_task__/NumEpisodes                  5
MetaTest/__unnamed_task__/StdReturn                  133.188
MetaTest/__unnamed_task__/SuccessRate                  0
MetaTest/__unnamed_task__/TerminationRate              0
MetaTrain/Average/AverageDiscountedReturn           -557.496
MetaTrain/Average/AverageReturn                     -557.496
MetaTrain/Average/Iteration                            0
MetaTrain/Average/MaxReturn                         -551.652
MetaTrain/Average/MinReturn                         -563.339
MetaTrain/Average/NumEpisodes                          2
MetaTrain/Average/StdReturn                            5.84347
MetaTrain/Average/SuccessRate                          0
MetaTrain/Average/TerminationRate                      0
MetaTrain/__unnamed_task__/AverageDiscountedReturn  -557.496
MetaTrain/__unnamed_task__/AverageReturn            -557.496
MetaTrain/__unnamed_task__/Iteration                   0
MetaTrain/__unnamed_task__/MaxReturn                -551.652
MetaTrain/__unnamed_task__/MinReturn                -563.339
MetaTrain/__unnamed_task__/NumEpisodes                 2
MetaTrain/__unnamed_task__/StdReturn                   5.84347
MetaTrain/__unnamed_task__/SuccessRate                 0
MetaTrain/__unnamed_task__/TerminationRate             0
TotalEnvSteps                                       6900
--------------------------------------------------  ----------
2025-01-08 14:58:57 | [CL_point_env] epoch #1 | Pre-Training Encoder...
2025-01-08 14:58:58 | [CL_point_env] epoch #1 | Pre-Training Encoder Done...
2025-01-08 14:58:58 | [CL_point_env] epoch #1 | Training...
2025-01-08 14:59:00 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 14:59:21 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 14:59:46 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 15:00:06 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 15:00:26 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 15:00:54 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 15:01:26 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 15:02:02 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 15:02:39 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 15:03:16 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 15:03:53 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 15:04:29 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 15:05:05 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 15:05:42 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 15:06:19 | [CL_point_env] epoch #1 | Training Encoder

2025-01-08 15:06:53 | [CL_point_env] epoch #1 | Evaluating...
2025-01-08 15:06:53 | [CL_point_env] epoch #1 | Sampling for adapation and meta-testing...
2025-01-08 15:06:54 | [CL_point_env] epoch #1 | Finished meta-testing...
embedding:  [[ 0.2540849   0.632546   -0.04643668  0.2520383  -0.68530774]]
embedding:  [[ 0.2537595   0.63253003 -0.04756157  0.25256208 -0.6851731 ]]
2025-01-08 15:06:54 | [CL_point_env] epoch #1 | Sampling for adapation and meta-testing...
2025-01-08 15:06:57 | [CL_point_env] epoch #1 | Finished meta-testing...
embedding:  [[ 0.25401342  0.6323752  -0.04686983  0.25221786 -0.6853963 ]]
embedding:  [[ 0.25426534  0.63269717 -0.0462404   0.25190124 -0.68516505]]
embedding:  [[ 0.25406167  0.6326733  -0.04754297  0.2524905  -0.68495655]]
embedding:  [[ 0.25406328  0.6326207  -0.04661872  0.25224555 -0.68515825]]
embedding:  [[ 0.25345713  0.63248986 -0.04589226  0.25156313 -0.6858031 ]]
2025-01-08 15:06:58 | [CL_point_env] epoch #1 | Saving snapshot...
2025-01-08 15:06:58 | [CL_point_env] epoch #1 | Saved
2025-01-08 15:06:58 | [CL_point_env] epoch #1 | Time 803.10 s
2025-01-08 15:06:58 | [CL_point_env] epoch #1 | EpochTime 482.44 s
--------------------------------------------------  ---------
MetaTest/Average/AverageDiscountedReturn             -379.132
MetaTest/Average/AverageReturn                       -379.132
MetaTest/Average/Iteration                              1
MetaTest/Average/MaxReturn                           -179.818
MetaTest/Average/MinReturn                           -518.243
MetaTest/Average/NumEpisodes                            5
MetaTest/Average/StdReturn                            120.931
MetaTest/Average/SuccessRate                            0
MetaTest/Average/TerminationRate                        0
MetaTest/__unnamed_task__/AverageDiscountedReturn    -379.132
MetaTest/__unnamed_task__/AverageReturn              -379.132
MetaTest/__unnamed_task__/Iteration                     1
MetaTest/__unnamed_task__/MaxReturn                  -179.818
MetaTest/__unnamed_task__/MinReturn                  -518.243
MetaTest/__unnamed_task__/NumEpisodes                   5
MetaTest/__unnamed_task__/StdReturn                   120.931
MetaTest/__unnamed_task__/SuccessRate                   0
MetaTest/__unnamed_task__/TerminationRate               0
MetaTrain/Average/AverageDiscountedReturn            -349.192
MetaTrain/Average/AverageReturn                      -349.192
MetaTrain/Average/Iteration                             1
MetaTrain/Average/MaxReturn                          -178.52
MetaTrain/Average/MinReturn                          -519.863
MetaTrain/Average/NumEpisodes                           2
MetaTrain/Average/StdReturn                           170.672
MetaTrain/Average/SuccessRate                           0
MetaTrain/Average/TerminationRate                       0
MetaTrain/__unnamed_task__/AverageDiscountedReturn   -349.192
MetaTrain/__unnamed_task__/AverageReturn             -349.192
MetaTrain/__unnamed_task__/Iteration                    1
MetaTrain/__unnamed_task__/MaxReturn                 -178.52
MetaTrain/__unnamed_task__/MinReturn                 -519.863
MetaTrain/__unnamed_task__/NumEpisodes                  2
MetaTrain/__unnamed_task__/StdReturn                  170.672
MetaTrain/__unnamed_task__/SuccessRate                  0
MetaTrain/__unnamed_task__/TerminationRate              0
TotalEnvSteps                                       11631
--------------------------------------------------  ---------
2025-01-08 15:07:00 | [CL_point_env] epoch #2 | Pre-Training Encoder...
Traceback (most recent call last):
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/examples/torch/multi_env_CL.py", line 205, in <module>
    CL_point_env()
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/experiment/experiment.py", line 369, in __call__
    result = self.function(ctxt, **kwargs)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/examples/torch/multi_env_CL.py", line 202, in CL_point_env
    trainer.train(n_epochs=num_epochs, batch_size=batch_size)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/trainer.py", line 396, in train
    average_return = self._algo.train(self)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/torch/algos/CLMeta.py", line 327, in train
    self._optimize_contrastive_loss(indices)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/torch/algos/CLMeta.py", line 394, in _optimize_contrastive_loss
    self._policy.infer_posterior(neg_context)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/torch/policies/cl_context_conditioned_policy.py", line 134, in infer_posterior
    params = self._context_encoder.forward(context)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/torch/modules/mlp_module.py", line 73, in forward
    return super().forward(input_value)[0]
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/torch/modules/multi_headed_mlp_module.py", line 149, in forward
    x = layer(x)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
Traceback (most recent call last):
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/examples/torch/multi_env_CL.py", line 205, in <module>
    CL_point_env()
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/experiment/experiment.py", line 369, in __call__
    result = self.function(ctxt, **kwargs)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/examples/torch/multi_env_CL.py", line 202, in CL_point_env
    trainer.train(n_epochs=num_epochs, batch_size=batch_size)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/trainer.py", line 396, in train
    average_return = self._algo.train(self)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/torch/algos/CLMeta.py", line 327, in train
    self._optimize_contrastive_loss(indices)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/torch/algos/CLMeta.py", line 394, in _optimize_contrastive_loss
    self._policy.infer_posterior(neg_context)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/torch/policies/cl_context_conditioned_policy.py", line 134, in infer_posterior
    params = self._context_encoder.forward(context)
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/torch/modules/mlp_module.py", line 73, in forward
    return super().forward(input_value)[0]
  File "/Users/paulnitschke/Desktop/projects/geo_meta_rl/garage/torch/modules/multi_headed_mlp_module.py", line 149, in forward
    x = layer(x)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/paulnitschke/miniconda3/envs/env_geo_meta_rl/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
